name: Deploy do lemuria.studio/ai

on:
  push:
    branches: [ main ]

jobs:
  deploy:
    runs-on: ubuntu-latest
    timeout-minutes: 15
    steps:
      - name: Checkout
        uses: actions/checkout@v4
      
      - name: Install lftp
        run: sudo apt-get update && sudo apt-get install -y lftp
      
      - name: Deploy via lftp
        env:
          FTP_HOST: ${{ secrets.SFTP_HOST }}
          FTP_USER: ${{ secrets.SFTP_USER }}
          FTP_PASS: ${{ secrets.SFTP_PASS }}
          FTP_PORT: ${{ secrets.SFTP_PORT }}
        run: |
          lftp -e "set ftp:ssl-allow no; set net:timeout 10; set net:max-retries 3; set net:reconnect-interval-base 5; mirror -R --delete --verbose --exclude .git/ --exclude .github/ ./ /lemuria.studio-ohp9/public_html/ai/; bye" -u $FTP_USER,$FTP_PASS ftp://$FTP_HOST:$FTP_PORT
